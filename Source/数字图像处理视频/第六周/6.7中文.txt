【未完成版本】
欢迎回来 现在我们将用一个例子说明 变分法在图像处理中的应用 这些技术 都在前面的视频中出现过 让我们开始吧 我们将使用到 基于偏微分方程的图像处理领域中 最著名的方程之一 那就是 各向异性扩散 (Anisotropic Diffusion) 这是什么呢？ 回忆一下 在我们讨论 高斯滤波和图像平均时 曾提到过 这两种方法相当于将像素值扩散到整幅图像 那样做的结果是模糊的图像 因为如果图像中有边界 而我们是跨边界求平均 使得边界两侧原本差异巨大的像素值进行混合 也就产生了 模糊 那是各向同性平滑(Isotropic Smoothing) 各向同性平滑是不考虑所平滑的范围内是否有边界 而各向异性平滑或 扩散要做的 是考虑对象中的边界后 在边界的某一侧对 像素值进行平均 如此 平均只会发生在值较接近的像素群中 这本身就是去噪声或图像增强的过程 被平均的像素值并无巨大差异 如何实现 使用方程来实现 就是这里的偏微分方程 在看方程之前 先看图像 这是原图 假如对原图使用高斯平滑或平均 我们知道图像会 变模糊 因为高斯平滑 是不区分边界的对所有像素值进行平均 所以会模糊对象的边界 这里可以看到结果 如果我们不想模糊边界 那只能先区分边界 并只对边界的某一侧像素 进行处理 而不再涉及这个方向 这样一来得到的边界会更加锐利 我们消除了对象内部的噪点 就是这张脑部MRI(核磁共振图像)中灰色的部分 可以看出 现在的图像平滑多了 但同时边界仍然十分明晰 这就是两者的区别 上红色背景的是各向同性扩散 热量方程 之前我们已经提到过 我们将使用变分法对方程进行推导 在求二阶导数之前已经加上了各向同性 二阶导数是分散函数 在此提醒大家 图像的拉普拉斯算子是梯度的分散函数 此前已经学过如何定义梯度和分散函数 在我们计算梯度和分散函数之前 我们先引入一个函数 这个函数与之前用作计数器的函数十分类似 比如这个函数可能是基于梯度的函数 我们在下一张中将看到 这个函数可能会说 等一下 如果某处梯度变化巨大 则在此处 停止扩散过程 这使得扩散只能在梯度没有巨大变化的某些方向上进行 而在出现边界 也就是梯度出现巨大变化的某些方向上 不会进行平均或只有减弱的平均 这些方向 也是我们保留锐利边界的地方 我们在对对象内部进行平滑降噪的同时保留了清晰锐利的边界 这正是我们想要的 这些方程是变分法推导出的 任意定义一个关于 梯度的函数 这是之前见过的 取u或u的导数的函数 梯度是图像的导数 rho在这里相当于f 定义任意关于梯度大小的函数 使用Euler-Lagrange方程展开 得到这个式子 这是这个式子的Euler-Lagrange变换 如果你严格按照之前视频中的步骤 来做的话 记住 偏微分方程是通过对图像进行 Euler-Lagrange变形得到的 当这个不再变化时 就解出了Euler-Lagrange方程 得到了 可能仅是局部的 使得方程值最小的解 再重复一遍 仅进行之前视频中讲过的Euler-Lagrange变换 用几个具体的rho函数为例 例如 rho(a)=a^2 要最小化的是 梯度大小的平方 然后是Euler-Lagrange变换 rho(a)=a^2 rho‘等于2a 将式子中的rho‘替换为2 x rho的自变量 也就是梯度 得到这个式子 Euler-Lagrange方程为I(t) 等于rho‘ 也就是2a的分散函数 可以忽略2 因为它仅仅是个标量 所以a 乘以 a在此处为梯度大小的绝对值 这是这部分 这部分不变 这部分等于rho‘ 分子分母相同消除 式子变为自变量为梯度的分散函数 也就是拉普拉斯算子 在这个例子中 Euler-Lagrange 方程与热量方程一致 是各向同性 是各向同性平滑 梯度大小绝对值的平方 Euler-Lagrange方程 也是一般的热量方程 是各向同性扩散 让我们再来看一个非常有趣的例子 令rho(a)=a 函数等于自变量 也可以使它等于a的绝对值 但我们现在 不纠缠这些细节 rho‘＝1 也就是说 现在是对 梯度的绝对值求最小值 不再是对梯度平方求最小值了 是梯度的绝对值 而不是平方 这个式子的 Euler-Lagrange方程是什么 rho‘现在是常数 现在变为被梯度自身正则化的梯度的分散函数 我得到的不再是热量方程 而是一个正则因子 这个因子说 等一下  如果梯度太陡 你就跨过了梯度 先缓一缓 从而把这些边界保留下来 这是各向异性扩散的一个例子 这方法被成为全变差 (Total variation）也就是这个式子 现在我想让你们思考一下 这部分是什么 在前面的视频中学过 这是图像i中水平线的曲率 之前我们把它作为泛函数使用 当时我们使用的是函数phi 这是图像中每条水平线的曲率 我们将图像抽象为一个平面 对图像进行变形 对图像使用各向异性扩散 扩散的方向是图像中水平线的曲率 得到的就是各向异性扩散 这个联系非常有趣 我们讲过曲线演化 也讲过基于曲率的运动 这就是其中一种 大体上 图像是沿着水平线的曲率 来移动的 我们并不关心 图像中的水平线 方程也不是从水平线推导出来的 我们是使用全变差的Euler-Lagrange变换推导出方程的 但它们却被联系起来 联系点是无论是按照水平线的曲率 还是按照Euler-Lagrange方程来移动 它们都是按照曲率方程来移动 什么的曲率？ 是图像中水平线的曲率 这是曲线演化 水平线和变分法之间一个饶有兴味的联系 这个联系本身也是各向异性扩散的一个非常美妙的方程 这也是在图像处理中 使用变分法的著名例子之一 我们将在下个视频中对这周进行小结 将涉及一点活动轮廓模型 也是使用曲线 演化和变分法的主战场 就像我们以前讨论过的那样 这些将在下个视频中看到 非常感谢 非常期待 谢谢
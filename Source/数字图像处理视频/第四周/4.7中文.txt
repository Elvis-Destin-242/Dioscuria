大家好，欢迎回来。我们接下来讲 维纳滤波 所以我们必须记住我们在这儿看到的 基础退化模型   我们又遇到了它 不过  像以前一样  一个大体上 运动模糊的滤波会导致焦点模糊 产生了噪点  我们就是要研究噪点 接下来我们观察噪点  我们试图从我们的观察中重建图像。 在这  我们要设计一个名为 维纳滤波的滤波。
在特定情况下  维纳滤波会帮助我们得到 非常非常好的修复 维纳滤波的基本思想是  我们尽可能使 重建信号和原信号之间的均方根最小 所以我要写出方差 它基本上是原信号和重建信号 之间的平方误差期望值 过去我们已经多次讲过这种类型的误差 我们要把它平方一下 就是这样了 从而它变成了平方误差的期望值 到这你或许会想 我不知道原始西格玛值 修复的关键就是在于在不知道原信号的情况下得到 它的近似值 但是我们已经有了期望值
所以我们没必要知道原始信号 我们只需要知道原始信号的一些 统计值特征 
现在不难看出要用在这儿的滤波 将会使它最小化 我们将得到下面的式子 重构信号的傅立叶变换 我先写下来再解释下我写的东西 （它的傅里叶变换等于）滤波的共轭 也就是用之前视频中讲到的方法得到的 滤波的傅里叶变换的复共轭 除以所估计的滤波的大小 所以这是退化滤波 还有能量谱  不用担心 如果你记不清或者忘记了它是什么意思 稍后我会再次提示 噪声的能谱  除以这个信号的能谱 所有的这些乘以观测值 所以 这个是维纳滤波 它乘以我们观测值 得要重建的滤波 当然 我们要倒过来 逆傅里叶变换得到基本的 得到估计 然后又一次 这是在做什么呢   这是在使均方差最小 我必须向你解释或者说提醒  这些概念是什么 但在这之前  如果你想知道我如何 从最小均方差到这个表达式   这实际上不难 比如  你可以在这个维基页面中找到 这真的不难 你基本只要照着所说的写 均方差、期望的定义   并且我们知道在我们 在求函数最小值的时求导 我很快就会讲到这个 所以就让我再次解释下这个 公式 在这儿又遇到了 退化滤波的傅里叶变换的共轭复数 这大致上是 没有什么比大小平方  并且正像我说的这是能量谱， 所以   噪点和原始信号的能量谱或者 信号类   能谱大致上是 傅里叶变换和相关函数的量度 所以有了F 
F有相关函数 你对他做傅里叶变换  你计算它的大小 得到的结果就是这个信号的能量谱   对噪点来说也是一样的。 对噪点采样  计算出它的相关度  对 它做完全变换 
算出等级 就是 能量谱  所以你不必知道函数 你需要知道噪点 确切的函数或者确切的噪点  你需要知道它的一些 统计学特征 所以这是理想的维纳滤波 当然 为了你真正实现它  你需要知道了解这点。 所以  大多数情况下有非常简便的窍门来计算  而不采用估计的方法。 这基本上会被替换 我想用个不同的颜色 这些 所有的这些表达   都很难去 估算 除非你知道你信号的很多统计学特征 这基本上是被一个常数替代 很惊讶吧   一个非常复杂的东西被一个常数 替代  所以 我再也不用它了 基本上我 去用常数代替 接下来 我只需要估计一个数。 当然假设 我已经 估计了退化 基本上 像高斯或者产生 运动模糊的滤波那样会产生降解的运算 所以非常简单的运算 
仅有一个未知数的简单滤波 可以通过很多种方式估计 但是我们现在不准备讨论这个 它基本上与我们要估计高斯方差 或是图像运动模糊程度的方法相似 它看上去和逆滤波非常相似 记住 在逆滤波中 我们要做的是拿到退化图像 也就是观测值 除以H的傅里叶变换 基本上是我们这里看到的这样的H 这儿有些小小不同 相似但是有差别。 这些细微的差别是至关重要的 我们将会在下面的例子中看到。 让我们看看这些图片
我们以前看过这些图片 这是原始图片  这大概是对图像进行湍流处理 后的结果  正如我们之前了解和讨论过的一样 这个模型通常情况下使用高斯滤波 这是反滤波后的结果  所以我们基本上采用高斯滤波 我们对它进行傅里叶变换 用这张图 也就是它的傅里叶变换 除以高斯方法处理过的傅里叶变换 再进行重建 没有别的事了 拿过这张图 对它进行傅里叶变换 除以高斯方法的傅里叶变换 然后对结果进行逆傅里叶变换 是的 我会说 确实是一个坏结果
我们都知道为什么 我们在除的时候  虽然高斯不会等于零  但它的值会变得非常小 这大概上提高很多 使我们的重建非常非常不稳定 另一方面说 这是维纳滤波的结果 我认为这是一个突出的成果 所以它大致上是我们在 以前的幻灯片上看到的  在这里成为了高斯滤波器 滤波等于共轭除以H^2加常数 这是我们在这张图片上使用的滤波 我们在高斯滤波上不使用1    或者1/H 我们用这个滤波得到了很好地结果 这儿的结果基本是通过不断试错得到的 我们尝试了最初知道的可能最好的K值 为了更好地有逻辑的原因  基本上是为了向你展示如果我们 估计了常数值 能用维纳滤波能得多好的结果 为了让你看到这不是唯一能退化的例子 让我们再讲一个以前看过的图像 有一张图像  它是我们用的这本书的封面 只不过是黑白的 它有运动 
我们已经看到了 所以它有 运动模糊 
接下来我们添加噪点 接下来进行处理 我们准确地知道运动模糊 所以我们 计算滤波的准确值  进行反滤波 这就是我们得到的结果 所以 又一次 从这到那是 把这个图像用逆滤波-1/H进行处理后的结果
我没有包括可能会发生的问题 因为我需要估计时间 事实上我把创建这个图像的具体时间 写下 ，结果由于同样的原因结果很糟糕 正如在之前的例子里看到的 这是维纳滤波的结果 可以吗？ 再来一次 这是我们这里的用的 我们用教学中能用的最好的常数 来评估内部滤波器的功率 现在 
你可能看到污点和 噪点
在这儿事实上我们取了一份 更小数量级的噪点
同样的模糊 同样的运动模糊 我们再次 应用逆滤波维纳 同样非常非常不好
基本上我们在这里恢复的 是运动
其他的我们都不能恢复 但是维纳滤波效果非常好 如果我们进一步降低噪点
降五个数量级 就什么噪点也看不到了
如果两者一比较 基本上是 噪点非常小 以至于优势降解是 运动模糊
这就是逆滤波 现在好多了 但是仍不是非常好 再次 这只不过是一个逆滤波器 但是被应用到模糊和噪点的图像上 这是维纳滤波的结果 这一列是逆滤波的结果 这一列是维纳滤波 这里是不同程度的噪点 我认为我们得到了完美的结果
为什么说完美 因为正如我在例子中说的一样 在这种人工设计出教学示例中我们不必 估计H  我们知道H 我们估计出最合适的K 但这说明这个滤波非常强大 只要我们估计出退化滤波或是运动模糊 以及常数 而滤波逆滤波 很抱歉 我们即使知道准确的H值 它也不太好使 所以我想让你了解维纳滤波是一个非常简单的函数 它可以非常非常强大 所以这里我们结束了维纳滤波部分 在接下来的视频中我们将要基本上结束修复单元 非常感谢
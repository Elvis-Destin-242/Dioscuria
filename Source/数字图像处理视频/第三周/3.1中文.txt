大家好 欢迎来到图像和视频处理第三周的课程 你们现在看到 我在一个非常暗的房间里 你们应该可以看到我身后的杜克教堂 但是有一些细节你们是看不到的 比如说我身上穿的衣服的颜色 或者看向我的桌子 这里非常的暗 你们基本上看不到什么 如果我们拿到这样一张图像要怎么处理？ 如果我们拿到一个背景非常暗的视频又要怎么处理？ 我们在晚上拍照的时候 这种情况经常发生 或者没有理想的采光 图像就可能太暗或者太亮 有时候噪点太多 我们这周要学的就是如何改善这些图像 如何进行图像增强 我们从最简单的操作开始 这些操作会帮助提高对比度 消除噪点 我们在本周最后的课程 会讲一些更先进的技术 这些都是现今最顶尖的技术 而在课程的最后 大概是第七周或第八周的时候 我们也会回过头来 讲解图像增强中非常非常前沿的技术 在这周和下周中 我们还会做一些线上的实时演示 在这里我会教你们一些背景知识 然后我们一起运行一些不同的软件平台 来实践一下这些操作 就在我的电脑上 大家可以看到 它们在实践中如何操作的 我们还会介绍一些在线的视频小测试 我会在视频中有些停顿 这样大家就可以思考一下我提的问题 这并不会对大家最后拿到证书产生影响 我只是想要给大家一点时间 在我给出答案前思考这些问题 就像平时上课一样 我会停下让学生们来想一想 我先去把灯打开 再来给大家讲课和板书 并给大家解释图像增强、对比度增强 以及图像去噪的基本原理 所以大家等我一下 我去开个灯 马上就回来 现在我把灯打开了 大家就能看到一些细节了 大家可能看不太清背景了 但是可以看到屋内的东西 我要给大家讲的就是如何在电脑中用数字化方式开灯 所以如果照片已经照好了 大家又不能回到之前的场景重新照 我想要利用图像和视频处理软件来“开灯” 现在我们就要开始了 我们要从非常简单的操作开始 都是一些直方图修正 或者说是逐点运算 这个图表明了它的基本思想 图像中的每一个像素 都会根据一个特定的方程 改变它的值 因此 这里的像素值会改变并移动到一个新的图像中 但它只会根据自身的像素值来改变 而不会被图像中其它任何部分的像素影响到 这是第三周课程中的第一部分 后面我们将了解如何利用图像中的其它信息改变像素值 但我们要先从非常简单的逐点运算开始 这里输入值是一个特定的像素值 输出值也是一个特定的像素值 这里也一样 例如这个运算中 所有小于 k 的像素值都会变成 0 而大于k 的像素值会变成 1 或者是图像中的最大值 这里进行了 阈值处理 所以现在要确立一个一维函数 来将输入值转化为输出值 现在大家来看看一下几个例子 这里有一些图示 一些变换操作 比如反对数 当然我们先从恒等变换开始 输入值与输出值相等 这就是恒等变换 如果我们把输出值写作 s 那么正比函数的表达式是 s = r 输出值等于输入值 我们没有改变图像 还有对数运算 比如输出值是一个常数乘以输入值的对数 我们一般会加1 因为如果输入是0 我们就没有办法取0的对数 所以我们这样处理 这就是要做的运算 不管输入的灰度值是什么 我们都会将其转化为输出值 还有反转 画在了这里 我想让大家想一下 什么函数可以表示反转 考虑到图像中的值是从0到L的 最小值是0 最大值是L 函数会是什么样的呢？ 我想把 s 写成 一个关于 r 的函数 怎样的函数才能对图像进行反转？ 输入的最大值会变成0 而最小值也就是0 会变成 L 所以大家来想一下 这是一个非常简单的练习 用来展示一下 这种运算有多么简单 并且我们等一下会看到 它又是多么强大 现在我问问大家 如何构建这个函数 这非常简单 我们想要输出值成为输入值的反转 那么 s = L - r 其中 L为最大值 这样当 r等于 L的时候 s就会变成0 即 L-L 当r等于0 那么s就变成了L 也就是最大值 所以这是一个非常非常简单的将灰度值反转的运算 注意 这里所有的运算 实际上都只关心灰度值 这里并不关心像素在图像中的位置 而只关心像素值 只关心图像的灰度值是多少 这里有一个例子 我们刚才写的这个 s = L-r 的方程 取了所有像素的反转值 所以会得到反转图像 我们可以看到 有一些细节在反转图像中比在原图中更容易辨认 这是为什么？ 记得之前我们讨论过视觉系统的一些特点 我们对于某些对比更加敏感 在不同的背景下我们可以看得更加清楚 我们看到了有一些对比在深色区域下更加清晰 而有一些对比在浅色区域中会显得不同 所以图像反转 可能会帮助我们 看清在原图中很难注意到的东西 这是很简单的例子 这些操作还有一个重要性质 即这些运算是可逆的 如果从这里开始 我们并没有破坏任何信息 因而可以做简单的逆向运算回到原图 我们在这周后续课程中会看到 这并不总是可行的 但是这种特殊的运算是可以的 另外一个非常重要的运算是指数函数 我写在这里 输出值s 会变成一个常数乘以输入值的 γ次方 这里的基本思路是 根据特定的 γ 我们会得到不同的函数 来将输入值转换成输出值 通常把这称作伽马校正 这是一个在显示器中非常常用的函数 由于显示器的一些特性 如果不对图像做伽马校正 那么图像会显得特别暗 所以如果这是我的图像 那么它会变得非常暗 这样会很难看清其中的细节 这是显示器的一些特性造成的 所以有时在将图片发送到显示器之前 需要做伽马校正 如果对图像做了伽马校正 再发送到显示屏 伽马校正就会抵消 由于显示器的特性而产生的变暗的效果 所以这是非常有用并且非常常见的运算 基本上每个显示器 在显示之前都会做伽马校正 但是伽马校正 或者说这个指数函数 一般来说 在延展像素值时 也非常有用 还记得直方图吧 它显示了像素的分布 例如 我们来看看这个图像 大多数的像素会聚集在较亮的值上 如果我们要画直方图 我们以后会经常画直方图 基本上从下个视频开始 这周会画很多直方图 所以 如果我们要画这个图像的像素分布 那么在这个区域的像素会占很多 因为我们可以看到这个图像中 有很多高像素值的点 画面很亮 所以有了伽马校正 我们就可以延展这个直方图 这里用了不同的 γ 值 但是我认为这张图最直观 首先 我们可以看到这里生成了一个更好的图像 比这个图像看起来要好 并且它还会帮助我们更好地看清一些细节 虽然大家的显示器中都在做各自的伽马校正 但我希望你们都能看得清楚 所以大家可以更清楚地看到这里、这里和其它不同区域中的细节 有时候可能校正过度 所以大家可能会选择不同的 γ 值来做伽马校正 大家可能会觉得 这个区域 有很多细节其实看不清 所以或许大家会用另外一个 γ 值 就像这里展示的 这些是用不同 γ 值得出的图像 大家可以只对图像的一些区域做这些运算 而不用应用到整个图像 大家可以只对图像的一些区域做反转 也可以只对图像的一些区域 做伽马校正或者使用指数函数 大家并不用将这些运算应用在所有地方 可以只在局部应用 所以这是一个非常简单的运算 并且可以立即给我们一个更清晰的图像 记住在这个视频开端 我的视频是非常暗的 这就意味着像素值的分布 是集中在这里的 如果这是直方图分布 这种运算会帮助我们延展这个分布 这样会更好地利用显示屏中的资源 可以用到0到255整个范围 而不仅仅是较暗或者较亮部分的值 再次强调 这是一个非常非常简单的运算 这些运算的设计中有很多技巧 但是有了经验 我们会慢慢理解需要做什么 这里是另外一个像素值拉伸的例子 这里依旧是输入值 r 这里是输出值s 如果你的像素值是在 这个点和这个点之间 那么基本上不会发生什么 这里是原图像 比较暗的像素值不会有什么变化 比较亮的像素值也不会有什么变化 而介于中间的像素值 会被拉伸 它的斜率远大于 1 如果斜率是1 那么像素会保持不变 如果斜率小于1 相当于像素值被压缩 如果斜率大于1 就会被拉伸 如果我们有一个大于1的斜率 0还是0 但是1会被拉伸 增加到斜率值 我们来看看这个效果 这是原图像 因为中间区域的像素值被延展了 大家就能突然看清之前无法辨识的细节了 仔细观察这里非常难注意到的点 在这里却能够看到这张图像在这里是有斑点的 大家如果想的话 可以对图像做阈值处理 就像这里做的一样 然后大家就可以分辨不同的区域 但是注意从这里到这里的变化 这里非常难看清图像内容 这个图像比之前好看许多 不仅如此 我们还可以看到很多图像中的细节 这在图像分析中非常重要 我们可以做像阈值处理这样简单的操作 这里用到的都是极其简单的运算 顺便提一下 这里用到这个变换运算 从这里到这里同样用到了一个非常简单的运算 实际上我们之前看到过这个运算 这里用到的是这个运算 所以这里是s 这里是r 如果像素值低于某一个特定值 那么它们就会变成0 而有些高于这个值 那么它们就会变成图像中可以显示的最大值 所以非常简单的运算却可以在图像中 做非常明显并且非常有用的变换 这里有一些其它的例子 这个有些像阀值处理 但只是突出了中间区域 如果像素值在0到A之间 就让它变成一个很低的值 如果像素值大于B 也变成一个非常低的值 而在中间的值变得非常高 这里是另外一个例子 如果像素值在0和A之间 那么就保持不变 像素值大于B 也保持不变 而令像素值在A和B之间的变得非常亮 或者也可以非常非常暗 假设 我们感兴趣的区域 像素值在A和B之间 并且我们想要强调这个区域 大家就可以做这种运算 或者这种运算 我们在下一张幻灯片中看一下它们的效果 这是原图像 这是第一种运算 我们来选取图像的一个区域 使其非常亮 让其它所有区域都非常暗 这是另外一个例子 这是第二个例子 我们选取图像中一个区域 并且只改变图像中的这个区域 其它所有区域都保持不变 当然 我们需要知道要被关注的区域在哪 像我之前说的 这就是需要从经验中得来的 或是从我们捕捉的景物信息中得到 在这个例子中 就是指有关生物学的信息 还有这个区域在图像中是用哪些像素值表示的 这便是我们要变亮或者变暗的区域 这里也是一样的 这里我是想要给大家展示 我们如何利用极其简单的运算达到目的 来改善图像的视觉效果 将非常暗或者非常亮的区域 变为像素值分布非常均匀 并且清晰的图像 这些运算还能帮助我们突出感兴趣的区域 如果大家想要在图像中这个区域做分析 那么可以将其它区域都变得非常暗 这样注意力就会被集中到这里 但或许大家会觉得 这样会丢失图像中的细节 因为这个区域都变成白色了 我们也可以做些其它的变换 我们可以将整个背景变成0 但不改变这个区域的值 这里显示的就是这种运算 我们将所有不感兴趣的区域 变得非常暗或者非常亮 但是所有我们感兴趣的地方都保持不动 这样我们就能 只将目光集中在那个区域 所以这都是一些非常简单的运算 下一个视频我们会开始 讲解直方图均衡化 但在这之前 我们会做一个简短的视频 来实时运行这里的一些运算 这样我们就可以看到它们是多么简单 同时观察它们在图像上的效果 下个视频再见 谢谢大家